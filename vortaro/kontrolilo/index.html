<!doctype html>
<html lang="eo">

<head>
  <meta charset="utf-8">
  <title>
  Vortejo/Vortaro/Kontrolilo
</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/vortejo/main.min.9e5d150549c46467befcce0030a4a2c558fc4b65a224c2c11d21d39d1270d0c6.css" integrity="sha256-nl0VBUnEZGe&#43;/M4AMKSixVj8S2WiJMLBHSHTnRJw0MY=">

  <link rel="icon" href="icon.png">
  <script src="/vortejo/eo.92344117ce3016df895c4413cae5596c5a5edb7f4c1ff5aeb896fe2af825ba0f.js" integrity="sha256-kjRBF84wFt&#43;JXEQTyuVZbFpe239MH/WuuJb&#43;Kvglug8="></script>
  <script src="/vortejo/main.1031c88d4cd33b30b0e9ee374a887e59fcdafef6cc3c4f6469dd4a7dd957d0fe.js" integrity="sha256-EDHIjUzTOzCw6e43Soh&#43;Wfza/vbMPE9kad1KfdlX0P4="></script>

</head>

<body class="">

  <div id="ŝirmilo" hidden>
    <div class="montrilo">
      testset
    </div>
  </div>

  <div id="unuvorto" hidden>
    <p>Radiko: <span f="ra"></span></p>
    <p>Speco: <span f="sp"></span></p>
    <p>Fonto: <span f="fo"></span></p>
    <p>Fakoj: <span f="fa"></span></p>
    <p>Vidu: <span f="vi"></span></p>
    <p>Angle: <span f="an"></span></p>
  </div>

  
    <header>
      <h1>
        <a href="/vortejo">
          <span>Vortejo</span>
        </a>
      </h1>
    </header>
  

  
<main aria-role="main">
  <h1 id="kontrolilo">Kontrolilo</h1>
<p>Eta kaj iom stulta ilo por kontroli ĉu teksto enhavas neoficialajn vortojn. Enmetu la tekston sube, premu la &ldquo;ek&rdquo; butonon. La rezulto estas la teksto, kun la vortoj partigitaj en subvortojn, laŭ la radikoj de la vortaro.</p>
<p>Estas ofte multaj kieloj laŭ kiu oni povas partigi vorton, inkluzive de tiuj kiuj ne estas tute laŭregulaj, do la sistemo trovas ĉiujn kaj tiam elektas la plej verŝajne. La nombro post ĉiu vorto estas la kiomo de eblaj partigoj - alklaku vorton por vidi tiujn. Eblas ke la elektita ne estas la intenca.</p>
<p>Vorto kun oranĝkolora fono estas nekomprenebla uzanta la vortaron.</p>

<div class="kontrolilo">

  <div class="stato">
    pretiĝanta
  </div>

  <form class="formo" hidden>
    <textarea name="teksto" placeholder="enigi tekston ĉie tie"></textarea>
    <button type="submit">ek</button>
    <button type="button" name="mp">malplenigi</button>
  </form>

  <div class="rezulto" hidden>
  </div>

  <div class="lavorto" hidden>
  </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  let ilo = null

  let e0 = document.querySelector('.kontrolilo')
  let eS = e0.querySelector('.stato')
  let eF = e0.querySelector('form')
  let eT = eF.querySelector('[name=teksto]')
  let eR = e0.querySelector('.rezulto')
  let eM = e0.querySelector('.lavorto')

  function pretigu(o) {
    ilo = o
    montruTeksto(eS)

    eF.addEventListener('submit', e  => {
      e.preventDefault()
      komprenu(eT.value)
    })
    eF.querySelector("[name=mp]").addEventListener('click', e  => {
      eT.value = ''
    })

    komprenu(eT.value)
    eF.hidden = false
  }

  const dividŜablono = /[^-A-Za-zĉĝĥĵŝŭĈĜĤĴŜŬ]/

  function komprenu(teksto) {
    malplenigu(eR)

    if (!teksto) {
      eR.hidden = true
      eM.hidden = true
      return
    }

    let lasteMarkita = null
    function markuUzoj(radiko) {
      if (lasteMarkita) {
        for (let v of lasteMarkita.vortoj) {
          v.classList.remove('markita')
        }
      }
      for (let v of radiko.vortoj) {
        v.classList.add('markita')
      }
      lasteMarkita = radiko
    }

    let nivelajNombroj = new Map()
    let uzatajRadikoj = new Map()
    let malbonajVortoj = new Map()

    let eNombroj = mkel('div', { classes: [ 'nombroj' ] })
    let eTeksto = mkel('div', { classes: [ 'teksto' ] })
    let eRadikoj = mkel('div', { classes: [ 'radikoj' ] })
    let eMalbonaj = mkel('div', { classes: [ 'malbonaj' ] })

    
    for (v of teksto.split(dividŜablono)) {
      if (v.length == 0) {
        continue
      }
      let vs = mkel('span')

      let eblaVorto = ilo.komprenuVorton(v.toLowerCase())
      let unua = eblaVorto.ebloj[0]

      vs.textContent = unua.vorto

      if (!unua.eraro) {
        let bonaj = eblaVorto.ebloj.reduce((a, e) => a + (e.eraro ? 0 : 1), 0)
        if (bonaj > 1) {
          vs.textContent += ` (${bonaj})`
        }

        vs.classList.add('nivelo-' + unua.nivelo)

        let nombro = nivelajNombroj.get(unua.nivelo) || 0
        nivelajNombroj.set(unua.nivelo, nombro + 1)

        for (let x of unua.eroj) {
          let r = uzatajRadikoj.get(x.origino.nomo)
          if (!r) {
            r = {
              radiko: x.origino,
              vortoj: []
            }
            uzatajRadikoj.set(r.radiko.radiko, r)
          }
          r.vortoj.push(vs)
        }
      } else {
        vs.textContent = unua.vorto
        vs.title = unua.eraro.join(', ')
        vs.classList.add('warn')

        let nombro = nivelajNombroj.get('x') || 0
        nivelajNombroj.set('x', nombro + 1)

        malbonajVortoj.set(eblaVorto.teksto, eblaVorto)
      }

      vs.addEventListener('click', () => montruVorto(eblaVorto))
      eTeksto.append(vs, ' ')
    }

    
    for (let x of [...uzatajRadikoj.values()].sort((a, b) => eoCompare(a.radiko.radiko, b.radiko.radiko))) {
      let vs = mkel('span', { classes: [ 'nivelo-' + x.radiko.nivelo ] })
      vs.append(x.radiko.radiko)
      
      
      
      vs.addEventListener('click', e => {
        markuUzoj(x)
        montruRadiko(x.radiko)
      })
      eRadikoj.append(vs, ' ')
    }

    
    for (let x of [...malbonajVortoj.values()].sort((a, b) => eoCompare(a.teksto, b.teksto))) {
      let vs = mkel('span')
      vs.textContent = x.teksto
      vs.addEventListener('click', () => montruVorto(x))
      eMalbonaj.append(vs, ' ')
    }

    
    for (let x of [...nivelajNombroj].sort()) {
      let vs = mkel('span')
      vs.textContent = x[1]
      vs.style.flexGrow = x[1]
      if (x[0] != 'x') {
        vs.classList.add('nivelo-' + x[0])
        vs.title = 'nivelo ' + x[0]
      } else {
        vs.classList.add('warn')
      }
      eNombroj.append(vs)
    }

    eR.append(eNombroj, eTeksto, eRadikoj, eMalbonaj)

    eR.hidden = false
  }

  function montruVorto(eblaVorto) {
    malplenigu(eM)

    let l = document.createElement('ol')
    for (let x of eblaVorto.ebloj) {
      let ero = document.createElement('li')
      ero.textContent = `${x.vorto} - ${x.speco} (${x.poentoj})`
      if (!x.eraro) {
        ero.classList.add('nivelo-' + x.nivelo)
      } else {
        ero.classList.add('warn')
        ero.title = x.eraro.join(', ')
      }
      l.append(ero)
    }
    eM.append(l)

    eM.hidden = false
    montru(eM)
  }

  eo('\/vortaro').
  then(
    o => pretigu(o),
    e => montruEraro(eS, e))
})
</script>



  <div class="links">
    
      <a href="/vortejo/vortaro/listo/">&lt; Reen</a>
    
    <a href="https://undeconstructed.github.io/vortejo/">Hejmen</a>
    
      <a href="/vortejo/vortaro/problemoj/">Antaŭen &gt;</a>
    
  </div>
</main>


  <footer>
    <span>Copyright 2020 | <a href="https://github.com/undeconstructed/">Kontakti min</a> | Vidi la <a href="/vortaro">Vortara datenaro</a> (kaj <a href="https://github.com/undeconstructed/vortaro">ĝia fonto</a>).</span>
  </footer>

</body>

</html>
