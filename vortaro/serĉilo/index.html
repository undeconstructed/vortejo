<!doctype html>
<html lang="eo">

<head>
  <meta charset="utf-8">
  <title>
  Vortejo/Vortaro/Serĉilo
</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/vortejo/main.min.9a24e4e1e095cb6466fb36afb8b2cc88bbc81cfd6365454759fb0c24ea184a0b.css" integrity="sha256-miTk4eCVy2Rm&#43;zavuLLMiLvIHP1jZUVHWfsMJOoYSgs=">

  <link rel="icon" href="icon.png">
  <script src="/vortejo/eo.fe0024a94b6c3650bffb0bc50622a44991a56218058e7658c295a1442370ea5d.js" integrity="sha256-/gAkqUtsNlC/&#43;wvFBiKkSZGlYhgFjnZYwpWhRCNw6l0="></script>
  <script src="/vortejo/main.881fce7da7e4cb543f146eaaf92f58cd714fc6b49ba3aace059de48ec879a7eb.js" integrity="sha256-iB/Ofafky1Q/FG6q&#43;S9YzXFPxrSbo6rOBZ3kjsh5p&#43;s="></script>

</head>

<body class="">

  <div id="ŝirmilo" hidden>
    <div class="montrilo">
      testset
    </div>
  </div>

  <div id="unuvorto" hidden>
    <p>Radiko: <span f="ra"></span></p>
    <p>Speco: <span f="sp"></span></p>
    <p>Fonto: <span f="fo"></span></p>
    <p>Fakoj: <span f="fa"></span></p>
    <p>Vidu: <span f="vi"></span></p>
    <p>Angle: <span f="an"></span></p>
  </div>

  
    <header>
      <h1>
        <a href="/vortejo">
          <span>Vortejo</span>
        </a>
      </h1>
    </header>
  

  
<main aria-role="main">
  <h1 id="serĉilo">Serĉilo</h1>
<p>Ĉi tiu ilo unue serĉas radikojn kiuj komenciĝas per la donataj literoj. Se neniu tia radiko ekzistas, ĝi provas dividi la teksto kaj trovi radikojn ene. Se vi nur volas la duan alternativon, metu &ldquo;.&rdquo; post la vorto.</p>

<div class="serĉilo">

  <div class="stato">
    pretiĝanta
  </div>

  <form class="formo" hidden>
    <input type="text" name="teksto" placeholder="radiko"/>
    <button type="submit">ek</button>
    <button type="button" name="mp">malplenigi</button>
  </form>

  <div class="rezulto" hidden>
  </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  let ilo = null
  let elektitaFako = null

  let e0 = document.querySelector('.serĉilo')
  let eS = e0.querySelector('.stato')
  let eF = e0.querySelector('form')
  let eT = eF.querySelector('[name=teksto]')
  let eR = e0.querySelector('.rezulto')

  function pretigu(o) {
    ilo = o
    montruTeksto(eS)

    eF.addEventListener('submit', e  => {
      e.preventDefault()
      serĉu(eT.value)
    })
    eF.querySelector("[name=mp]").addEventListener('click', e  => {
      eT.value = ''
    })

    serĉu(eT.value)
    eF.hidden = false
  }

  function serĉu(teksto) {
    if (teksto.length == 0) {
      return
    }
    malplenigu(eR)

    if (teksto.endsWith('.')) {
      serĉuDividante(teksto.slice(0, -1))
    } else {
      if (serĉuTrovante(teksto)) {
        
      } else {
        serĉuDividante(teksto)
      }
    }
    eR.hidden = false
  }

  function serĉuTrovante(teksto) {
    let trovata = []
    for (let r of ilo.radikoj) {
      if (r.radiko.startsWith(teksto)) {
        trovata.push(r)
      }
    }
    if (trovata.length == 0) {
      return false
    }
    let l = document.createElement('ul')
    for (let t of trovata) {
      let ero = document.createElement('li')
      let s = document.createElement('span')
      s.textContent = t.radiko
      s.addEventListener('click', e => {
        montruRadiko(t)
      })
      ero.append(s)
      ero.append(` (${t.fakoj.join(', ')})`)
      l.append(ero)
    }
    eR.append(l)
    return true
  }

  function kreuDivLinio(d) {
    let ero = document.createElement('li')
    let unua = true
    if (d.eroj) {
      let fakoj = new Set()
      for (let r of d.eroj) {
        r.o.fakoj.forEach(e => fakoj.add(e))
        if (unua) {
          unua = false
        } else {
          ero.append('/')
        }
        let s = document.createElement('span')
        s.textContent = r.r
        s.className = 'nivelo-' + r.o.nivelo
        s.addEventListener('click', e => {
          montruRadiko(r.o)
        })
        ero.append(s)
      }
      ero.append(` (${[...fakoj.values()].filter(e => !e.endsWith('o')).sort().join(', ')})`)
    } else {
      let s = document.createElement('span')
      s.textContent = d.vorto
      ero.append(s)
    }
    if (d.eraro) {
      ero.append(` (${d.eraro.join(', ')})`)
    }
    return ero
  }

  function serĉuDividante(teksto) {
    let divRez = ilo.komprenuVorton(teksto)

    let l = document.createElement('ul')
    for (let d of divRez.bonaj) {
      l.append(kreuDivLinio(d))
    }
    eR.append(l)

    l = document.createElement('ul')
    l.classList.add('warn')
    for (let d of divRez.malbonaj) {
      l.append(kreuDivLinio(d))
    }
    eR.append(l)
  }

  eo('\/vortaro').
  then(
    o => pretigu(o),
    e => montruEraro(eS, e))
})
</script>



  <div class="links">
    
      <a href="/vortejo/vortaro/principoj/">&lt; Reen</a>
    
    <a href="https://undeconstructed.github.io/vortejo/">Hejmen</a>
    
      <a href="/vortejo/vortaro/listo/">Antaŭen &gt;</a>
    
  </div>
</main>


  <footer>
    <span>Copyright 2020 | <a href="https://github.com/undeconstructed/">Kontakti min</a> | Vidi la <a href="/vortaro">Vortara datenaro</a> (kaj <a href="https://github.com/undeconstructed/vortaro">ĝia fonto</a>).</span>
  </footer>

</body>

</html>
